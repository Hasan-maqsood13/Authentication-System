<h2>Reset Password</h2>
<form method="post" id="resetForm">
  {% csrf_token %}
  <input type="hidden" name="email" value="{{ email }}">
  <div>
    <input type="password" id="new_password" name="new_password" placeholder="New password" required>
  </div>
  <div id="password-contain">
    <p id="pass-length" class="invalid">Min 8 chars</p>
    <p id="pass-lower" class="invalid">Lowercase letter</p>
    <p id="pass-upper" class="invalid">Uppercase letter</p>
    <p id="pass-number" class="invalid">Number</p>
    <p id="pass-special" class="invalid">Special char</p>
  </div>
  <div>
    <input type="password" id="confirm_password" name="confirm_password" placeholder="Confirm password" required>
    <div id="match-error" class="text-danger"></div>
  </div>
  <div class="text-danger">{{ error }}</div>
  <button type="submit">Reset Password</button>
</form>

<script>
document.addEventListener("DOMContentLoaded", function() {
  const pass = document.getElementById("new_password");
  const confirm = document.getElementById("confirm_password");
  const matchError = document.getElementById("match-error");
  const checks = {
    length: document.getElementById("pass-length"),
    lower: document.getElementById("pass-lower"),
    upper: document.getElementById("pass-upper"),
    number: document.getElementById("pass-number"),
    special: document.getElementById("pass-special"),
  };

  pass.addEventListener("input", function() {
    const v = pass.value;
    checks.length.classList.toggle("text-success", v.length >= 8);
    checks.lower.classList.toggle("text-success", /[a-z]/.test(v));
    checks.upper.classList.toggle("text-success", /[A-Z]/.test(v));
    checks.number.classList.toggle("text-success", /\d/.test(v));
    checks.special.classList.toggle("text-success", /[!@#$%^&*(),.?\":{}|<>]/.test(v));
  });

  confirm.addEventListener("input", function() {
    matchError.textContent = pass.value === confirm.value ? "" : "Passwords do not match.";
  });
});
</script>
